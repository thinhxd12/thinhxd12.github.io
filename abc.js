const getSheetData = async () => {
    const res = await fetch(ggsUrl + '?action=getAllData', { method: 'GET' });
    return res.json();
}


const getSheetDataPS = async () => {
    const res = await fetch(ggsUrl + '?action=getAllDataPass', { method: 'GET' });
    return res.json();
}

const importData = () => {
    getSheetData().then(data => {
        let newdata = data.filter(item => item.val)
        newdata = newdata.map(item => {
            let wordOrig = item.val.replace(/(.+?)\s\-(.+)/, "$1");
            let word = wordOrig.replace(/(.+)\s\|.+/, "$1");
            let phonetic = wordOrig.replace(/.+\s\|\s(.+)\s\|/, '$1');
            let meaning = item.val.replace(wordOrig, "");
            return {
                text: word,
                phonetic: phonetic,
                meaning: meaning,
                numb: item.numb,
            }
        })
        // console.log(newdata);
        let url = 'https://ap-southeast-1.aws.data.mongodb-api.com/app/data-tcfpw/endpoint/import?collection=hoctuvung'
        fetch(url, {
            method: 'POST',
            body: JSON.stringify(newdata)
        }).then(res => res.json()).then(data => console.log(data))

    })
}

// importData();

const importDataHistory = () => {

    let url = 'https://ap-southeast-1.aws.data.mongodb-api.com/app/data-tcfpw/endpoint/import?collection=history'
    fetch(url, {
        method: 'POST',
        body: JSON.stringify(historyTable)
    }).then(res => res.json()).then(data => console.log(data))
}


const historyTable = [
    {
        "item1": {
            "0": {
                "row": "1-200",
                "fromD": "2022/08/21",
                "toD": "2022/08/26"
            },
            "1": {
                "row": "201-400",
                "fromD": "2022/09/02",
                "toD": "2022/09/07"
            },
            "2": {
                "row": "401-600",
                "fromD": "2022/08/27",
                "toD": "2022/09/01"
            },
            "3": {
                "row": "601-800",
                "fromD": "2022/09/08",
                "toD": "2022/09/13"
            },
            "4": {
                "row": "801-1000",
                "fromD": "2022/09/14",
                "toD": "2022/09/19"
            }
        }
    },
    {
        "item2": {
            "0": {
                "row": "1-200",
                "fromD": "2022/09/20",
                "toD": "2022/09/25"
            },
            "1": {
                "row": "201-400",
                "fromD": "2022/09/26",
                "toD": "2022/10/01"
            },
            "2": {
                "row": "401-600",
                "fromD": "2022/10/02",
                "toD": "2022/10/07"
            },
            "3": {
                "row": "601-800",
                "fromD": "2022/10/08",
                "toD": "2022/10/13"
            },
            "4": {
                "row": "801-1000",
                "fromD": "2022/10/14",
                "toD": "2022/10/19"
            }
        }
    },
    {
        "item1": {
            "0": {
                "row": "1001-1200",
                "fromD": "2022/10/20",
                "toD": "2022/10/25"
            },
            "1": {
                "row": "1201-1400",
                "fromD": "2022/10/26",
                "toD": "2022/10/31"
            },
            "2": {
                "row": "1401-1600",
                "fromD": "2022/11/01",
                "toD": "2022/11/06"
            },
            "3": {
                "row": "1601-1800",
                "fromD": "2022/11/07",
                "toD": "2022/11/12"
            },
            "4": {
                "row": "1801-2000",
                "fromD": "2022/11/13",
                "toD": "2022/11/18"
            }
        }
    },
    {
        "item2": {
            "0": {
                "row": "1-200",
                "fromD": "2022/11/19",
                "toD": "2022/11/24"
            },
            "1": {
                "row": "201-400",
                "fromD": "2022/11/25",
                "toD": "2022/11/30"
            },
            "2": {
                "row": "401-600",
                "fromD": "2022/12/01",
                "toD": "2022/12/06"
            },
            "3": {
                "row": "601-800",
                "fromD": "2022/12/07",
                "toD": "2022/12/11"
            },
            "4": {
                "row": "801-1000",
                "fromD": "2022/12/13",
                "toD": "2022/12/18"
            }
        }
    },
    {
        "item1": {
            "0": {
                "row": "1001-1200",
                "fromD": "2023/01/06",
                "toD": "2023/01/11"
            },
            "1": {
                "row": "1201-1400",
                "fromD": "2022/12/31",
                "toD": "2023/01/05"
            },
            "2": {
                "row": "1401-1600",
                "fromD": "2023/01/12",
                "toD": "2023/01/17"
            },
            "3": {
                "row": "1601-1800",
                "fromD": "2022/12/25",
                "toD": "2022/12/30"
            },
            "4": {
                "row": "1801-2000",
                "fromD": "2022/12/19",
                "toD": "2022/12/24"
            }
        }
    },
    {
        "item2": {
            "0": {
                "row": "1-200",
                "fromD": "2023/01/18",
                "toD": "2023/01/23"
            },
            "1": {
                "row": "201-400",
                "fromD": "2023/01/30",
                "toD": "2023/02/04"
            },
            "2": {
                "row": "401-600",
                "fromD": "2023/01/24",
                "toD": "2023/01/29"
            },
            "3": {
                "row": "601-800",
                "fromD": "2023/02/05",
                "toD": "2023/02/10"
            },
            "4": {
                "row": "801-1000",
                "fromD": "2023/02/11",
                "toD": "2023/02/16"
            }
        }
    },
    {
        "item1": {
            "0": {
                "row": "1001-1200",
                "fromD": "2023/03/01",
                "toD": "2023/03/06"
            },
            "1": {
                "row": "1201-1400",
                "fromD": "2023/03/13",
                "toD": "2023/03/18"
            },
            "2": {
                "row": "1401-1600",
                "fromD": "2023/02/17",
                "toD": "2023/02/22"
            },
            "3": {
                "row": "1601-1800",
                "fromD": "2023/03/07",
                "toD": "2023/03/12"
            },
            "4": {
                "row": "1801-2000",
                "fromD": "2023/02/23",
                "toD": "2023/02/28"
            }
        }
    },
    {
        "item2": {
            "0": {
                "row": "1-200",
                "fromD": "2023/03/19",
                "toD": "2023/03/24"
            },
            "1": {
                "row": "201-400",
                "fromD": "2023/03/31",
                "toD": "2023/04/05"
            },
            "2": {
                "row": "401-600",
                "fromD": "2023/03/25",
                "toD": "2023/03/30"
            },
            "3": {
                "row": "601-800",
                "fromD": "2023/04/06",
                "toD": "2023/04/11"
            },
            "4": {
                "row": "801-1000",
                "fromD": "2023/04/12",
                "toD": "2023/04/17"
            }
        }
    },
    {
        "item1": {
            "0": {
                "row": "1001-1200",
                "fromD": "2023/04/30",
                "toD": "2023/05/05"
            },
            "1": {
                "row": "1201-1400",
                "fromD": "2023/05/12",
                "toD": "2023/05/17"
            },
            "2": {
                "row": "1401-1600",
                "fromD": "2023/04/18",
                "toD": "2023/04/23"
            },
            "3": {
                "row": "1601-1800",
                "fromD": "2023/05/06",
                "toD": "2023/05/11"
            },
            "4": {
                "row": "1801-2000",
                "fromD": "2023/04/24",
                "toD": "2023/04/29"
            }
        }
    },
    {
        "item2": {
            "0": {
                "row": "1-200",
                "fromD": "2023/05/18",
                "toD": "2023/05/23"
            },
            "1": {
                "row": "201-400",
                "fromD": "2023/06/05",
                "toD": "2023/06/10"
            },
            "2": {
                "row": "401-600",
                "fromD": "2023/05/24",
                "toD": "2023/05/29"
            },
            "3": {
                "row": "601-800",
                "fromD": "2023/06/11",
                "toD": "2023/06/16"
            },
            "4": {
                "row": "801-1000",
                "fromD": "2023/05/30",
                "toD": "2023/06/04"
            }
        }
    },
    {
        "item1": {
            "0": {
                "row": "1001-1200",
                "fromD": "2023/06/23",
                "toD": "2023/06/28"
            },
            "1": {
                "row": "1201-1400",
                "fromD": "2023/07/05",
                "toD": "2023/07/10"
            },
            "2": {
                "row": "1401-1600",
                "fromD": "2023/06/17",
                "toD": "2023/06/22"
            },
            "3": {
                "row": "1601-1800",
                "fromD": "2023/06/29",
                "toD": "2023/07/04"
            },
            "4": {
                "row": "1801-2000",
                "fromD": "2023/07/11",
                "toD": "2023/07/16"
            }
        }
    },
    {
        "item2": {
            "0": {
                "row": "1-200",
                "fromD": "2022/08/21",
                "toD": "2022/08/26"
            },
            "1": {
                "row": "201-400",
                "fromD": "2022/09/02",
                "toD": "2022/09/07"
            },
            "2": {
                "row": "401-600",
                "fromD": "2022/08/27",
                "toD": "2022/09/01"
            },
            "3": {
                "row": "601-800",
                "fromD": "2022/09/08",
                "toD": "2022/09/13"
            },
            "4": {
                "row": "801-1000",
                "fromD": "2022/09/14",
                "toD": "2022/09/19"
            }
        }
    },
    {
        "item1": {
            "0": {
                "row": "1-200",
                "fromD": "2022/09/20",
                "toD": "2022/09/25"
            },
            "1": {
                "row": "201-400",
                "fromD": "2022/09/26",
                "toD": "2022/10/01"
            },
            "2": {
                "row": "401-600",
                "fromD": "2022/10/02",
                "toD": "2022/10/07"
            },
            "3": {
                "row": "601-800",
                "fromD": "2022/10/08",
                "toD": "2022/10/13"
            },
            "4": {
                "row": "801-1000",
                "fromD": "2022/10/14",
                "toD": "2022/10/19"
            }
        }
    },
    {
        "item2": {
            "0": {
                "row": "1001-1200",
                "fromD": "2022/10/20",
                "toD": "2022/10/25"
            },
            "1": {
                "row": "1201-1400",
                "fromD": "2022/10/26",
                "toD": "2022/10/31"
            },
            "2": {
                "row": "1401-1600",
                "fromD": "2022/11/01",
                "toD": "2022/11/06"
            },
            "3": {
                "row": "1601-1800",
                "fromD": "2022/11/07",
                "toD": "2022/11/12"
            },
            "4": {
                "row": "1801-2000",
                "fromD": "2022/11/13",
                "toD": "2022/11/18"
            }
        }
    },
    {
        "item1": {
            "0": {
                "row": "1-200",
                "fromD": "2022/11/19",
                "toD": "2022/11/24"
            },
            "1": {
                "row": "201-400",
                "fromD": "2022/11/25",
                "toD": "2022/11/30"
            },
            "2": {
                "row": "401-600",
                "fromD": "2022/12/01",
                "toD": "2022/12/06"
            },
            "3": {
                "row": "601-800",
                "fromD": "2022/12/07",
                "toD": "2022/12/11"
            },
            "4": {
                "row": "801-1000",
                "fromD": "2022/12/13",
                "toD": "2022/12/18"
            }
        }
    },
    {
        "item2": {
            "0": {
                "row": "1001-1200",
                "fromD": "2023/01/06",
                "toD": "2023/01/11"
            },
            "1": {
                "row": "1201-1400",
                "fromD": "2022/12/31",
                "toD": "2023/01/05"
            },
            "2": {
                "row": "1401-1600",
                "fromD": "2023/01/12",
                "toD": "2023/01/17"
            },
            "3": {
                "row": "1601-1800",
                "fromD": "2022/12/25",
                "toD": "2022/12/30"
            },
            "4": {
                "row": "1801-2000",
                "fromD": "2022/12/19",
                "toD": "2022/12/24"
            }
        }
    },
    {
        "item1": {
            "0": {
                "row": "1-200",
                "fromD": "2023/01/18",
                "toD": "2023/01/23"
            },
            "1": {
                "row": "201-400",
                "fromD": "2023/01/30",
                "toD": "2023/02/04"
            },
            "2": {
                "row": "401-600",
                "fromD": "2023/01/24",
                "toD": "2023/01/29"
            },
            "3": {
                "row": "601-800",
                "fromD": "2023/02/05",
                "toD": "2023/02/10"
            },
            "4": {
                "row": "801-1000",
                "fromD": "2023/02/11",
                "toD": "2023/02/16"
            }
        }
    },
    {
        "item2": {
            "0": {
                "row": "1001-1200",
                "fromD": "2023/03/01",
                "toD": "2023/03/06"
            },
            "1": {
                "row": "1201-1400",
                "fromD": "2023/03/13",
                "toD": "2023/03/18"
            },
            "2": {
                "row": "1401-1600",
                "fromD": "2023/02/17",
                "toD": "2023/02/22"
            },
            "3": {
                "row": "1601-1800",
                "fromD": "2023/03/07",
                "toD": "2023/03/12"
            },
            "4": {
                "row": "1801-2000",
                "fromD": "2023/02/23",
                "toD": "2023/02/28"
            }
        }
    },
    {
        "item1": {
            "0": {
                "row": "1-200",
                "fromD": "2023/03/19",
                "toD": "2023/03/24"
            },
            "1": {
                "row": "201-400",
                "fromD": "2023/03/31",
                "toD": "2023/04/05"
            },
            "2": {
                "row": "401-600",
                "fromD": "2023/03/25",
                "toD": "2023/03/30"
            },
            "3": {
                "row": "601-800",
                "fromD": "2023/04/06",
                "toD": "2023/04/11"
            },
            "4": {
                "row": "801-1000",
                "fromD": "2023/04/12",
                "toD": "2023/04/17"
            }
        }
    },
    {
        "item2": {
            "0": {
                "row": "1001-1200",
                "fromD": "2023/04/30",
                "toD": "2023/05/05"
            },
            "1": {
                "row": "1201-1400",
                "fromD": "2023/05/12",
                "toD": "2023/05/17"
            },
            "2": {
                "row": "1401-1600",
                "fromD": "2023/04/18",
                "toD": "2023/04/23"
            },
            "3": {
                "row": "1601-1800",
                "fromD": "2023/05/06",
                "toD": "2023/05/11"
            },
            "4": {
                "row": "1801-2000",
                "fromD": "2023/04/24",
                "toD": "2023/04/29"
            }
        }
    },
    {
        "item1": {
            "0": {
                "row": "1-200",
                "fromD": "2023/05/18",
                "toD": "2023/05/23"
            },
            "1": {
                "row": "201-400",
                "fromD": "2023/06/05",
                "toD": "2023/06/10"
            },
            "2": {
                "row": "401-600",
                "fromD": "2023/05/24",
                "toD": "2023/05/29"
            },
            "3": {
                "row": "601-800",
                "fromD": "2023/06/11",
                "toD": "2023/06/16"
            },
            "4": {
                "row": "801-1000",
                "fromD": "2023/05/30",
                "toD": "2023/06/04"
            }
        }
    },
    {
        "item2": {
            "0": {
                "row": "1001-1200",
                "fromD": "2023/06/23",
                "toD": "2023/06/28"
            },
            "1": {
                "row": "1201-1400",
                "fromD": "2023/07/05",
                "toD": "2023/07/10"
            },
            "2": {
                "row": "1401-1600",
                "fromD": "2023/06/17",
                "toD": "2023/06/22"
            },
            "3": {
                "row": "1601-1800",
                "fromD": "2023/06/29",
                "toD": "2023/07/04"
            },
            "4": {
                "row": "1801-2000",
                "fromD": "2023/07/11",
                "toD": "2023/07/16"
            }
        }
    }
]



// importDataHistory()